
<launch>
  <!-- Robot ID parameter, can be set from command line with _robot_id:=your-id -->
  <arg name="robot_id" default="$(env ROBOMETRICS_ROBOT_ID robot-ros-001)"/>
  
  <!-- API key parameter, should be set from environment or command line -->
  <arg name="api_key" default="$(env ROBOMETRICS_API_KEY)"/>
  
  <!-- API URL parameter -->
  <arg name="api_url" default="$(env ROBOMETRICS_API_URL https://uwmbdporlrduzthgdmcg.supabase.co/functions/v1/telemetry)"/>
  
  <!-- Update rate in Hz (0.1 = 10 seconds) -->
  <arg name="update_rate" default="0.1"/>
  
  <!-- MQTT configuration -->
  <arg name="use_mqtt" default="$(env ROBOMETRICS_USE_MQTT false)"/>
  <arg name="mqtt_host" default="$(env ROBOMETRICS_MQTT_HOST mqtt.robometrics.xyz)"/>
  <arg name="mqtt_port" default="$(env ROBOMETRICS_MQTT_PORT 1883)"/>
  <arg name="mqtt_topic" default="$(env ROBOMETRICS_MQTT_TOPIC robometrics/telemetry/$(arg robot_id))"/>
  
  <!-- Start the bridge node -->
  <node name="robometrics_bridge" pkg="robometrics_bridge" type="robometrics_bridge.py" output="screen">
    <param name="robot_id" value="$(arg robot_id)"/>
    <param name="api_key" value="$(arg api_key)"/>
    <param name="api_url" value="$(arg api_url)"/>
    <param name="update_rate" value="$(arg update_rate)"/>
    <param name="use_mqtt" value="$(arg use_mqtt)"/>
    <param name="mqtt_host" value="$(arg mqtt_host)"/>
    <param name="mqtt_port" value="$(arg mqtt_port)"/>
    <param name="mqtt_topic" value="$(arg mqtt_topic)"/>
  </node>
</launch>
